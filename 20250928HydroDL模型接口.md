[toc]

# 洪涝模拟建模平台接口文档

## 建模范围文件传输

### 接口URL

> http://127.0.0.1:18896/grid/get_prj_region

### 请求方式

> POST

### 请求参数

> ```
> user_name # 用户名
> workspace_name  # # 工作方案名
> prj_name # 计算方案名称
> json_file  # 建模范围json文件字符串
> ```



### 成功响应示例

```json
jsonify({'status': 'success', 'msg': '计算区域文件保存成功'}), 200
```

### 失败响应示例

```
jsonify({'status': 'error', 'msg': f'计算区域文件保存失败，请重试: {str(e)}'}), 500
```

---



## 网格剖分

### 接口URL

> http://127.0.0.1:18896/grid/grid_generate

### 请求方式

> POST

### 请求参数

> ```
> user_name # 用户名
> workspace_name  # # 工作方案名
> prj_name # 计算方案名称
> 
> max_tri_area  # 网格剖分的最大面积
> bd_cls = data.get('boundary_tags', None)  # 网格边界类型指定
> bd_labels # 网格边界类型指定，可不传
> 
> encryption_zone # 内部加密区域的shp路径，可不传
> encryption_zone_area # 内部加密区域的网格最大允许面积，可不传
> 
> holes # 内部孔洞区域的shp路径，可不传
> hole_cls # 内部孔洞区域的标注，可不传
> geo_reference  # 指定边界多边形和内部区域的几何参考系，可不传
> 
> coastline  # 不会被三角网“跨越”的线shp，可不传
> region_point_zone  # 特定点的最大三角形面积，用于局部细化网格，可不传
> 
> min_tri_angle   # 控制网格中三角形的最小角度，用于提高网格质量， 
> fail_if_poly_outside  # 如果设置为 True，当内部区域或孔洞区域超出边界多边形时，函数将报错。
> use_cache # 函数将尝试使用缓存来加速网格生成
> verbose  # 打印log
> ```



### 成功响应示例

```json
{'status': 'success', 'msg': f'网格剖分成功'}
```

### 失败响应示例

```
jsonify({'status': 'error', 'msg': f'网格剖分失败，请重试: {str(e)}'}), 500
```

---



## 网格信息获取

### 接口URL

> http://127.0.0.1:18896/grid/get_grid_infos

### 请求方式

> POST

### 请求参数

> ```
> user_name # 用户名
> workspace_name  # # 工作方案名
> prj_name # 计算方案名称
> ```

### 成功响应示例

```json
{"status":"success","triangles":[[291680,309801,291676],[133,130,131]],"vertices":[[1928.23,23344.30],[1928.23,23344.30]]}
```

### 失败响应示例

```
jsonify({'status': 'error', 'msg': f'网格信息获取失败，请重试: {str(e)}'}), 500
```

---

## 地形插值

### 接口URL

> http://127.0.0.1:18896/grid/ele_interpolation

### 请求方式

> POST

### 请求参数

> ```
> user_name # 用户名
> workspace_name  # # 工作方案名
> prj_name # 计算方案名称
> set_store  # 保存计算结果,0:不保存计算结果；1保存后续计算结果；默认1就行  
> ```

### 成功响应示例

```json
jsonify({'status': 'success', 'msg': f'开始网格地形插值'}), 200
```

### 失败响应示例

```
jsonify({'status': 'error', 'msg': f'地形插值失败，请重试: {str(e)}'}), 500
```

---



## 地形插值状态

### 接口URL

> http://127.0.0.1:18896/grid/get_ele_interpolation_state

### 请求方式

> POST

### 请求参数

> ```
> user_name # 用户名
> workspace_name  # # 工作方案名
> prj_name # 计算方案名称
> ```



### 成功响应示例

```json
return {'status': 'success'}, 200

return {'status': 'waiting'}, 200
```

### 失败响应示例

```
return jsonify({'status': 'error', 'msg': f'结果获取失败，请重试: {str(e)}'}), 500
```

---



